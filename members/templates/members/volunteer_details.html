{% extends 'members/base.html' %}

{% block content %}
  <h1>Frivilligdetaljer</h1>
  <p>Velkommen til Coding Pirates' medlemssystem. Du ser nu oversigten over de oplysninger vi har registreret om dig som frivillig. Det er vigtigt du sikrer dig at oplysningerne er korrekte.</p>
  <p>For yderligere hjælp med at bruge denne side - se på <a href="http://codingpirates.dk/crmhjaelp/">"Sådan bruger du vores medlemssystem"</a> eller skriv til os på <a href="mailto:kontakt@codingpirates.dk">kontakt@codingpirates.dk</a>.</p>
  <p>Du er registreret på e-mail-adressen <a class="text-info">{{family.email}}</a>. Det er denne e-mail-adresse vi sender informationer til dig om tilmeding til hold og aktiviteter.</p>

  <h2>Min profil</h2>
  <p>Tryk på dit navn, for at checke og opdatere oplysningerne.</p>
  <div class="row">
    <div class="col-xs-12">
      <section class="panel panel-defualt">
        {% if family.person_set.count > 0 %}
        <table class="table table-striped table-responsive">
          <thead>
            <tr>
              <th class="col-xs-1">Opskrevet</th>
              <th class="col-xs-2" align="left">Navn</th>
              <th class="col-xs-3" align="left">Adresse</th>
              <th class="col-xs-2" align="left">Postnr./by</th>
              <th class="col-xs-2" align="left">Email</th>
              <th class="col-xs-1" align="left">Telefon</th>
            </tr>
          </thead>
          <tbody>
            {% for person in ordered_persons %}
              <tr>
                {%if person.membertype == 'CH' %}
                <td><p>{{person.added|date:"d M Y"}}</p>
                <p class="text-muted">({{person.added|timesince}} siden)</p></td>
                {%else%}
                <td></td>
                {%endif%}

                <td><p><a href="{% url 'person_update' person.id %}">{{person.name}}</a></p>

                {%if person.membertype == 'PA' %} <p class="text-muted">(Forælder)</p> {%endif%}
                {%if person.membertype == 'GU' %} <p class="text-muted">(Værge)</p> {%endif%}
                {%if person.membertype == 'CH' %} <p class="text-muted">(Barn, {{person.age_years}} år)</p> {%endif%}
                {%if person.membertype == 'NA' %} <p class="text-muted">(Frivillig)</p> {%endif%}

                </td>

                <td><p>{{person.address}}</p></td>
                <td><p>{{person.zipcode}} {{person.city}}</p></td>
                <td><p>{{person.email}}</p></td>
                <td><p>{{person.phone}}</p></td>
              </tr>
            {% endfor %}
          </tbody>
          <tfoot>
            <tr>
            </tr>
          </tfoot>
        </table>
        {% endif %}
        <br/>
        {%if request_parents %}
        <blockquote class="bg-warning">
          <p>Opret mindst 1 forælder / værge med kontaktoplysninger, så vi i Coding Pirates nemt kan få fat i dig.</p>
        </blockquote>
        {%endif%}
        {% if need_confirmation %}
        <blockquote class="bg-danger">
        <p> Det er længe siden du sidst bekræftede dine oplysninger. <a class="btn btn-success" href="{% url 'confirm_details' %}">Bekræft oplysninger</a>
        </blockquote>
        {%endif%}
      </section>
    </div>
  </div>

  {% if participating or waiting %}
  <h2>Tilmeldte aktiviteter</h2>
  <p>Dette er de aktiviteter/foreninger du er tilmeldt. Du kan klikke på navnet for hvert arrangement, for at se flere detaljer om hvor og hvornår det foregår. Du kan også se deltagerlisten for arrangementet.</p>
  <p>Hvis et arrangement har en rød <kbd>betal</kbd>-knap, er betalingen ikke registreret. Tryk på knappen for at betale.</p>
  <div class="row">
    <div class="col-xs-12">
      <section class="panel panel-default">
        <table class="table table-striped table-responsive">
          <thead>
            <tr>
              <th class="col-sm-3" align="left">Navn</th>
              <th>Aktivitet</th>
              <th class="col-sm-2">Start</th>
              <th class="col-sm-2">Slut</th>
            </tr>
          </thead>
          <tbody>
            {% for participation in participating %}
              <tr>
                <td>{{participation.member.person.name}}</td>
                <td><a href="{%url 'activity_view_person' participation.activity.id participation.member.person.id %}">{{participation.activity.name}} - {{participation.activity.department.name}}</a>
                {% if not participation.paid %}
                <a class="btn btn-danger" role="button" href="{{participation.get_payment_link}}">Betal</a>
                {%endif%}

                </td>
                <td>{{participation.activity.start_date}}</td>
                <td>{{participation.activity.end_date}}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </section>
    </div>
  </div>
  {% endif %}

  <h2>Invitationer / Åbne aktiviteter</h2>
  <p>Denne liste indeholder invitationer til aktiviteter. Du kan frit tilmelde den lokalforening du er en del af. Du vil modtage en e-mail på e-mail-adressen {{family.email}} når der er aktiviteter, som du kan tilmelde dig.</p>
  <div class="row">
    <div class="col-xs-12">
      <section class="panel panel-defualt">
        {% if invites or waiting_lists or open_activities%}
          <table class="table table-striped table-responsive">
            <thead>
              <tr>
                <th class="col-xs-3" align="left">Navn</th>
                <th class="col-xs-6" align="left">Aktivitet</th>
                <th class="col-xs-3 text-left" colspan="2">Reaktion</th>
              </tr>
            </thead>
            <tbody>

              {% for activity in open_activities %}
                  <tr>
                    <td> - </td>
                    <td><a href="{%url 'activity_view_family' activity.id %}">{{activity.name}} - <h4><b>Coding Pirates {{activity.department.name}}</b></h4></a></td>
                      <td>
                      {% for person in activity.persons %}
                    <td><a class="btn btn-success" href="{%url 'activity_signup' activity.id person.id %}">Tilmeld {{ person.firstname }} aktivitet</a></td>
                      {% endfor %}
                      </td>
                    <td></td>
                  </tr>
              {% endfor %}

              {% for invite in invites %}
                <tr>
                  <td>{{invite.person.name}}</td>
                  <td><a href="{%url 'activity_signup' invite.activity.id invite.person.id %}">{{invite.activity.name}} - <h4><b>{{invite.activity.department.name}}</b></h4></a></td>
                  <td><a class="btn btn-success" href="{%url 'activity_signup' invite.activity.id invite.person.id %}">Tilmeld aktivitet</a></td>
                  <td><a class="btn btn-danger" href="{%url 'invitation_decline' family.unique invite.id %}">Afslå</a></td>
                </tr>
              {% endfor %}

              </tbody>
          </table>
        {% else %}
          <blockquote class="bg-info">
          <p>Der er endnu ikke åbnet for tilmelding til aktiviteter. Vi sender en email til {{family.email}} når vi er klar til at modtage tilmeldinger.</p>
        </blockquote>
        {% endif %}
      </section>
    </div>
  </div>
{% endblock %}
